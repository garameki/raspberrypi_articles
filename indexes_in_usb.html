<html lang='ja'><head><meta charset="utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><link rel="stylesheet" type="text/css" href="style.css" /><link rel="stylesheet" type="text/css" href="style_fukidashi.css" />
<script type="application/javascript" src="script.js"></script>
<meta name="description" content="">
<title></title>
</head><body id="body">
<h1>ApacheにUSBの中身をインデックスで表示させる</h1>
<img src="indexes_in_usb_1.jpg"><br>
ログをブラウザから確認するとか、google spread sheetsにコピペする時とかに使うため。
<span class="spanExplain">コンテクスト</span>
<ul>
<li>/media/pi/TOSHIBAがUSBメモリのマウントポイント
<li>/media/pi/TOSHIBA/data/にcsvデータファイルが入っている
<li>raspberrypi.garameki.com/data/にブラウザからアクセスするとIndexes表示になる
</ul>
<h2>手順</h2>
<div class="pp">
<h3>1.cronなどの、USBメモリにアクセスするプロセスを無くしておく</h3>
<h3>2.パーミッション関係の設定</h3>
<div class="pp">
/media/pi/TOSHIBA/dataをIndexes表示させるために～
<span class="spanExplain">権限</span>
<pre>
drwxr-xr-x   3 root root  4096 11月  9 21:44 /media
drwxr-xr-x+ 4 755 root 4096 11月 24 16:24 /media/pi
drwxr-xr-x 4 pi   root 4096 11月 24 10:58 /media/pi/TOSHIBA
drwxr-x--- 2 pi   www-data 4096 11月 24 10:58 /media/pi/TOSHIBA/data
</pre>
<span class="spanExplain">マウント状態:usbの自動マウントのまま</span>
<pre>
$ mount -l | grep TOSHIBA
/dev/sda1 on /media/pi/TOSHIBA type ext4 (rw,nosuid,nodev,relatime,data=ordered,uhelper=udisks2) [TOSHIBA]
</pre>
<span class="spanExplain">/etc/apache2/sites-available/raspberrypi.confに追加する設定</span>
<pre>
	Alias /data/ /media/pi/TOSHIBA/data/
	<Directory "/media/pi/TOSHIBA/data">
		AllowOverride None
		Options Indexes
		Require all granted
	</Directory>
</pre>
<span class="spanExplain">Apache2の再起動</span>
<pre>
$ sudo service apache2 restart
</pre>
<span class="spanExplain">ブラウザで確認</span>
<pre>
raspberrypi.garameki.com/data/
</pre>
</div>

<h3>3.cronなどのログの再開</h3>
</div>

<h2>Google Spread Sheetsに上げてグラフを描いてみたい</h2>
<div class="pp">
<span class="spanExplain">参考サイト</span>
<ul>
<li><a href="https://qiita.com/murata0705/items/bb4b5c5490658ed0de4b">Qiita : グーグルスプレッドシート(GoogleSpreadSheet)でカンマ区切り文字列を分割してセルごとに貼り付ける方法</a>
<li><a href="https://www.appsupport.jp/docs/spreadsheet-graph/">入力したデータを元にグラフを作成</a>
</ul>
<img src="indexes_in_usb_2.jpg">
できた

</div>

<br><hr><div style="text-align:right;"><a href="http://raspberrypi.garameki.com#20181124">がらめきドットコム</a><br>Powered by RaspberryPi3B+ Raspbian stretch</div></body></html>
