<html lang='ja'><head><meta charset="utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><link rel="stylesheet" type="text/css" href="style.css" /><link rel="stylesheet" type="text/css" href="style_fukidashi.css" />
<script type="application/javascript" src="script.js"></script>
<meta name="description" content="2代目ラズパイへのhttpサーバー移管に伴う、初代ラズパイの設定変更">
<title>初代ラズパイの設定変更|がらめきドットコム</title>
</head><body id="body">
<h1>初代ラズパイの設定の変更</h1>
2代目を購入したので、初代ラズパイがになっていたhttpサーバーの役目を解くことにしました。<br>
websocketサーバーとして、あるいは、測定温度をGoogle Spread Sheetsに送るべく、Apache2は動き続けます。<br>
<h2>ルーターの設定を変更</h2>
<div class="pp">
ブラウザで
<pre>
172.16.255.254
</pre>
を開いて、ポート番号800を、初代のローカルIPアドレスに振る。<br>
必ず、「有効」をONにしてあるか、確認する
</div>

<h2>Apache2のポート設定を２か所変更</h2>
<div class="pp">
<h3>/etc/apache2/sites-available/raspberrypi.conf</h3>
<div class="pp">
<pre>
raspberrypi.garameki.com:80
</pre>
となっているのを、
<pre>
raspberrypi.garameki.com:800
</pre>
とする。
</div>


<h3>/etc/apache2/ports.conf</h3>
<div class="pp">
/etc/apache2/apache2.confで「include ports.conf」となっているので、/etc/apache2/ports.confを編集する<br>
<span class="spanExplain">/etc/apache2/ports.confの一部変更</span>
<pre>
#Listen 80
Listen 800
</pre>
に修正
<pre>
</div>

<h3>Apache2の再起動</h3>
<div class="pp">
<pre>
$ sudo service apache2 restart
</pre>
</div>
</div>


<h2>Google Spread Sheetsのスクリプトを変更する</h2>
<div class="pp">
<pre>
var response = UrlFetchApp.fetch("http://raspberrypi.garameki.com<span class="spanCaution">:800</span>/data/max31856_write.log");
</pre>
</div>

<h2>USBにログを記録できるか確認</h2>
<div class="pp">
できていないときは、
パーミッションが悪いので、/mediaから、ずーっと見直してみる。
<pre>
-rwxrwx--- pi root max31856_write.log
</pre>
で、動いていた。
</div>


<h2>websocket serverを立ち上げる</h2>
<div class="pp">
<pre>
$ cdsockets
$ python3 websocket-server.py 9801
</pre>
<pre>
$ cdsockets
$ python3 websocket-server.py 8801
</pre>
<pre>
$ cdsockets
$ python3 websocket-server.py 6601
</pre>
</div>


<h2></h2>
<div class="pp">
</div>


<h2></h2>
<div class="pp">
</div>


<h2></h2>
<div class="pp">
</div>


<h2></h2>
<div class="pp">
</div>


<h2></h2>
<div class="pp">
</div>



<br><hr><div style="text-align:right;"><a href="http://raspberrypi.garameki.com#">がらめきドットコム</a><br>Powered by RaspberryPi3B+ Raspbian stretch</div></body></html>
